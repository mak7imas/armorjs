/*! Armorjs 14-05-2015 */
(function(){"use strict";var a=this,b=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,c=a.armorjs,d=a.A,e=function(a,c){var d,f,g=c||document;try{if(e.isObject(a))d=a;else if(f=b.exec(a)){if(d=document.createElement(f[1]),e.isObject(g=c))for(f in g)d.setAttribute(f,g[f])}else{if(d=g.querySelectorAll(a),!d||!d.length)return null;e.isArrayType(d)&&1==d.length&&"#"==a.substr(0,1)&&(d=d[0])}e.ext(d,e.domlst)}catch(h){d=null}return d};e.noConflict=function(){return a.A===armorjs&&(a.A=d),a.armorjs===armorjs&&(a.armorjs=c),e},e.VERSION="0.0.1",e.ui={},a.A=a.armorjs=e,e.uid=function(){return this._sequence||(this._sequence=(new Date).valueOf()),this._sequence++,this._sequence},e.each=e.forEach=function(a,b){var c=0,d=a.length;if(!e.isArrayType(a))return b.call(a,c,a);for(;d>c&&b.call(a[c],c,a[c])!==!1;c++);return a},e.clone=function(a){var b,c=0,d=a.length;if(!a||"object"!=typeof a)return a;if(a instanceof Date)return b=new Date,b.setTime(a.getTime()),b;if(a instanceof Array){for(b=[];d>c;c++)b[c]=e.clone(a[c]);return b}if(a instanceof Object){b={};for(var f in a)a.hasOwnProperty(f)&&(b[f]=e.clone(a[f]));return b}return a},e.ext=function(a){var b,c,d,f=Array.prototype.slice.call(arguments,1);for(c=0;c<f.length;c++){d=f[c]||{};for(b in d)d.hasOwnProperty(b)&&(a[b]=e.clone(d[b]))}return a}}).call(this),A.xhr=function(){return new XMLHttpRequest},A.stor=function(){return window.localStorage},A.ajson=function(method,url,par,cb,cbe){var x=A.xhr();if(x.onreadystatechange=function(){if(4==x.readyState&&200==x.status){var rj,rr=x.responseText;try{rj=window.JSON?JSON.parse(rr):eval("("+rr+")"),cb(rj)}catch(e){cbe&&cbe(e,rr)}}},par instanceof Object){var s="";for(var p in par)s&&(s+="&"),s+=p+"="+encodeURIComponent(par[p]);par=s}return x.open(method,url,!0),"POST"===method?(x.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),x.send(par)):"GET"===method&&(par&&(url+=(-1==url.indexOf("?")?"?":"&")+par),x.open("GET",url),x.send()),x},A.isArray=function(a){return Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)},A.isArrayType=function(a){return"number"==typeof a.length&&void 0===a.tagName},A.isObject=function(a){return!!a&&a.constructor===Object},A.isString=function(a){return!!a&&a.constructor===String},A.nvl=function(a,b){return b=b||"",a||b},A.on=function(a,b,c,d){return a.addEventListener?a.addEventListener(b,c,!!d):a.attachEvent&&a.attachEvent("on"+b,c),a},A.off=function(a,b,c,d){return a.removeEventListener?a.removeEventListener(b,c,!!d):a.detachEvent&&a.detachEvent("on"+b,c),a},A.curStyle=function(a,b){return a.currentStyle?x.currentStyle[b]:window.getComputedStyle?window.getComputedStyle(a,null).getPropertyValue(b):void 0},A.onload=function(a){A.on(window,"load",a)},A.dict={params:{url:"armorjs_dict.php",dctlst:[]},load:function(a,b,c,d){{var e,f=this;this.params.dctlst}e=f._getStorDct(a,b),e?c&&c(e):(d&&d(),A.ajson("GET",this.params.url,{name:a,hash:b},function(a){f._setStorDct(a),c&&c(a)}))},_setStorDct:function(a){var b=A.stor(),c=this.params.dctlst;if(b)try{b.setItem(a.name,JSON.stringify(a)),c[name]=a}catch(d){console.log("storage is full"),b.clear()}},_getStorDct:function(a,b){var c,d=A.stor(),e=this.params.dctlst;if(c=e[a],!c&&d)try{c=JSON.parse(d.getItem(a)),!c||b&&c.hash!=b?c=null:e[a]=c}catch(f){return d.removeItem(a),null}return c}},A.domlst={each:function(a){return A.each(this,a)},ext:function(a){return this.each(function(b,c){var d=A.ext(c,A.domlst,a);return c.init&&c.init(),d}),this},on:function(a,b,c){return this.each(function(d,e){A.on(e,a,b,c)}),this},off:function(a,b,c){return this.each(function(d,e){A.off(e,a,b,c)}),this},find:function(a){return this.each(function(b,c){return A(a,c)})},attr:function(a,b){return this.each(function(c,d){var e,f=a;if(A.isString(f)){if(!b)return d.getAttribute(f);d.setAttribute(f,b)}else for(e in f)d.setAttribute(e,f[e]);return d})},css:function(a,b){return this.each(function(c,d){var e,f=d.style||{},g=a;if(A.isString(g)){if(!b)return f[g];f.hasOwnProperty(g)&&(f[g]=b)}else for(e in g)f.hasOwnProperty(e)&&(f[e]=g[e]);return d})}},armorjs.env={},function(){"use strict";(-1!=navigator.userAgent.indexOf("Mobile")||-1!=navigator.userAgent.indexOf("Windows Phone"))&&(armorjs.env.mobile=!0),(armorjs.env.mobile||-1!=navigator.userAgent.indexOf("iPad")||-1!=navigator.userAgent.indexOf("Android"))&&(armorjs.env.touch=!0),-1!=navigator.userAgent.indexOf("Opera")?armorjs.env.isOpera=!0:(armorjs.env.isIE=!!document.all||-1!==navigator.userAgent.indexOf("Trident"),armorjs.env.isFF=-1!=navigator.userAgent.indexOf("Firefox"),armorjs.env.isWebKit=-1!=navigator.userAgent.indexOf("KHTML"),armorjs.env.isSafari=armorjs.env.isWebKit&&-1!=navigator.userAgent.indexOf("Mac")),-1!=navigator.userAgent.toLowerCase().indexOf("android")&&(armorjs.env.isAndroid=!0,navigator.userAgent.toLowerCase().indexOf("trident")&&(armorjs.env.isAndroid=!1,armorjs.env.isIEMobile=!0)),armorjs.env.set=function(a,b){armorjs.env[a]=b},armorjs.env.unset=function(a){delete armorjs.env[a]}}(),A.ui.dialog={params:{title:""},init:function(){this._initParams(),this._initDialog()},_initParams:function(){this.params},_initDialog:function(){var a=A.curStyle(this,"z-index");a=isNaN(a)?1e4:a,this.css({zIndex:a,display:"none"});var b=this._backing=A("<div>");b.css({position:"fixed",display:"none",zIndex:--a,top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0)",pointerEvents:"none"}),document.body.appendChild(b),b.appendChild(this),this._ctitle(),this._cclose()},_ctitle:function(){var a=this._title=A("<div>",{"class":"am-dialog-title"});this.insertBefore(a,this.firstChild)},_cclose:function(){var a=this,b=this._close=A("<div>",{"class":"am-dialog-close"});b.innerHTML="x",this.appendChild(b,this.firstChild),b.on("click",function(){a.close()})},show:function(a){a=a?"block":"none";var b=this._backing,c=this._isModal,d=c?"auto":"none",e=c?"rgba(0,0,0,0.7)":"rgba(0,0,0,0)";b.css({display:a,pointerEvents:d,background:e}),this.css({display:a,pointerEvents:"auto"})},open:function(a){var b=this.params,c=this.attr("title");c&&(b.title=c,this.removeAttribute("title")),this._title.innerHTML=b.title,this._isModal=!!a,this.show(!0),this._isOpen=!0},close:function(){this.show(!1),this._isModal=!1,this._isOpen=!1}},A.ui.edit={params:{type:"C"},init:function(){this._initParams(),this.on("blur",function(){this._toCase(),this._valid()})},_initParams:function(){var a;switch(a=this.attr("COLTYPE")){case"C":this.params.type=a;break;case"D":this.params.type=a;break;case"T":this.params.type=a}},_toCase:function(){this.value=this.value.toLocaleUpperCase()},_valid:function(){try{switch(this.params.type){case"T":case"D":this._validDate();break;case"N":this._validNumber();break;case"I":this._validInteger();break;case"H":this._validHoursMinutes()}}catch(a){throw new Error("err")}return!0},valt:function(){return this.value},val:function(a){a=a||"";var b=this.value;return b!=a&&(this.value=a),this.value},_validDate:function(){var a=this.valt();if(a){a=a.split(" ");var b=A.nvl(a[0]),c=A.nvl(a[1]),d=new Date;if(b=b.replace(/[\.,/,\:,\-,\,]/g,"."),-1==b.indexOf(".")&&b.length>1)switch(b.length){case 2:b=b+"."+(d.getMonth()+1)+"."+d.getFullYear();break;case 4:b=b.substr(0,2)+"."+b.substr(2,2)+"."+d.getFullYear();break;case 6:case 8:b=b.substr(0,2)+"."+b.substr(2,2)+"."+b.substr(4)}var e=b.split("."),f=e[0],g=e[1],h=e[2];if(f||(f=d.getDate()),g||(g=d.getMonth()+1),h||(h=d.getFullYear()),2==h.length&&(h=20>h?"20"+h:"19"+h),c=c.replace(/[\.,/,\:,\-,\,]/g,":"),-1==c.indexOf(":")&&c.length>1)switch(c.length){case 2:c+=":00:00";break;case 4:c=c.substr(0,2)+":"+c.substr(2,2)+":00";break;case 6:c=c.substr(0,2)+":"+c.substr(2,2)+":"+c.substr(4)}e=c.split(":");var i=e[0],j=e[1],k=e[2];if(i||(i="00"),j||(j="00"),k||(k="00"),d=new Date(h,g-1,f,i,j,k),f=d.getDate(),g=d.getMonth(),h=d.getFullYear(),i=d.getHours(),j=d.getMinutes(),k=d.getSeconds(),isNaN(f)||isNaN(g)||isNaN(h)||isNaN(i)||isNaN(j)||isNaN(k))throw new Error("Error of date format");var l=function(a){return(String(a).length<2?"0":"")+a};this.val("T"===this.params.type?l(f)+"."+l(g+1)+"."+h+" "+l(i)+":"+l(j)+":"+l(k):l(f)+"."+l(g+1)+"."+h)}},_validHoursMinutes:function(){var a=this.valt();if(a){var b=a.replace(/[\.,/,\:,\-,\,]/g,":");if(-1==b.indexOf(":")&&b.length>1)switch(b.length){case 2:b+=":00";break;case 3:b=b.substr(0,2)+":"+b.substr(2,1)+"0";break;case 4:b=b.substr(0,2)+":"+b.substr(2,2)}var c=b.split(":"),d=A.nvl(c[0]),e=A.nvl(c[1]);d||(d="00"),parseInt(d)>23&&(d="23"),e||(e="00"),parseInt(e)>59&&(e="59");var f=function(a){return String(a).length<2?"0":""+a};this.val(f(d)+":"+f(e))}},_validNumber:function(){var a=this.valt();if(a){if(a=a.replace(/[\,]/g,"."),a=parseFloat(a),isNaN(a))throw new Error("Error number format");a=String(a).replace(/[\.]/g,","),this.val(a)}},_validInteger:function(){var a=this.valt();if(a){if(a=parseInt(a),isNaN(a))throw new Error("Error number format");this.val(a)}}},A.ui.select={params:{dictName:"",dictHash:"",value:"",prefval:"",isOptLoaded:!1},init:function(){this._initParams(),this._loadOptions()},_initParams:function(){var a=this.params;a.dictName=this.attr("DICTNAME"),a.dictHash=this.attr("DICTHASH"),a.value=this.attr("VALUE")||"",a.prefval=this.attr("PREFVAL")||""},_loadOptions:function(){var a=this.params,b=this;a.dictName&&!a.isOptLoaded&&A.dict.load(a.dictName,a.dictHash,function(c){var d,e,f=a.prefval.split(","),g=[],h=[];for(d=0,l=c.items.length;d<l;d++){var i=!1;e=c.items[d],e.sel=e.val==a.value;for(var j=0;j<f.length;j++)if(e.val==f[j]){g[j]=e,i=!0;break}i||h.push(e)}g=g.concat(h),b.setOptions(g,!0),a.isOptLoaded=!0})},setOptions:function(a,b){var c,d=0,e=a.length;for(this.options.length=0,b&&this.options.add(new Option(" ","-",1));e>d;d++)c=a[d],this.options.add(new Option(c.txt,c.val,0,c.sel))},val:function(a){return a&&(this.value=a),this.options.length?this.options[this.selectedIndex].value:null}};