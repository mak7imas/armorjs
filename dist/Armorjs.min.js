/*! Armorjs 28-04-2015 */
var A=function(a,b){var c;try{c=(b||document).querySelectorAll(a),A.isArrayType(c)&&1==c.length&&"#"==a.substr(0,1)&&(c=c[0]),A.ext(c,A.domlst)}catch(d){c=null}return c};window.A=A,A.ui={},A.each=function(a,b){var c=0,d=a.length;if(!A.isArrayType(a))return b.call(a,c,a);for(;d>c&&b.call(a[c],c,a[c])!==!1;c++);return a},A.clone=function(a){var b,c=0,d=a.length;if(!a||"object"!=typeof a)return a;if(a instanceof Date)return b=new Date,b.setTime(a.getTime()),b;if(a instanceof Array){for(b=[];d>c;c++)b[c]=clone(a[c]);return b}if(a instanceof Object){b={};for(var e in a)a.hasOwnProperty(e)&&(b[e]=A.clone(a[e]));return b}return a},A.ext=function(a){var b,c,d,e=Array.prototype.slice.call(arguments,1);for(c=0;c<e.length;c++){d=e[c]||{};for(b in d)d.hasOwnProperty(b)&&(a[b]=A.clone(d[b]))}return a},A.xhr=function(){return new XMLHttpRequest},A.stor=function(){return window.localStorage},A.json=function(method,url,par,cb,cbe){var x=A.xhr();if(x.onreadystatechange=function(){if(4==x.readyState&&200==x.status){var rj,rr=x.responseText;try{rj=window.JSON?JSON.parse(rr):eval("("+rr+")"),cb(rj)}catch(e){cbe&&cbe(e)}}},par instanceof Object){var s="";for(var p in par)s&&(s+="&"),s+=p+"="+encodeURIComponent(par[p]);par=s}return x.open(method,url,!0),"POST"===method?(x.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),x.send(par)):"GET"===method&&(par&&(url+=(-1==url.indexOf("?")?"?":"&")+par),x.open("GET",url),x.send()),x},A.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},A.isArrayType=function(a){return"number"==typeof a.length&&void 0===a.tagName},A.nvl=function(a,b){return b=b||"",a||b},A.on=function(a,b,c,d){return a.addEventListener?a.addEventListener(b,c,!!d):a.attachEvent&&a.attachEvent("on"+b,c),a},A.off=function(a,b,c,d){return a.removeEventListener?a.removeEventListener(b,c,!!d):a.detachEvent&&a.detachEvent("on"+b,c),a},A.onload=function(a){A.on(window,"load",a)},A.dict={params:{url:"armorjs_dict.php",dctlst:[]},load:function(a,b,c,d){{var e,f=this;this.params.dctlst}e=f._getStorDct(a,b),e?c&&c(e):(d&&d(),A.json("GET",this.params.url,{name:a,hash:b},function(a){f._setStorDct(a),c&&c(a)}))},_setStorDct:function(a){var b=A.stor(),c=this.params.dctlst;if(b)try{b.setItem(a.name,JSON.stringify(a)),c[name]=a}catch(d){console.log("storage is full"),b.clear()}},_getStorDct:function(a,b){var c,d=A.stor(),e=this.params.dctlst;if(c=e[a],!c&&d)try{c=JSON.parse(d.getItem(a)),!c||b&&c.hash!=b?c=null:e[a]=c}catch(f){return d.removeItem(a),null}return c}},A.domlst={each:function(a){return A.each(this,a)},ext:function(a){return this.each(function(b,c){var d=A.ext(c,A.domlst,a);return c.init&&c.init(),d}),this},on:function(a,b,c){return this.each(function(d,e){A.on(e,a,b,c)}),this},off:function(a,b,c){return this.each(function(d,e){A.off(e,a,b,c)}),this},attr:function(a,b){return this.each(function(c,d){return b&&d.setAttribute(a,b),d.getAttribute(a)})}},A.ui.edit={params:{type:"C"},init:function(){this._initParams(),this.on("blur",function(){this._toCase(),this._valid()})},_initParams:function(){var a;switch(a=this.attr("COLTYPE")){case"C":this.params.type=a;break;case"D":this.params.type=a;break;case"T":this.params.type=a}},_toCase:function(){this.value=this.value.toLocaleUpperCase()},_valid:function(){try{switch(this.params.type){case"T":case"D":this._validDate();break;case"N":this._validNumber();break;case"I":this._validInteger();break;case"H":this._validHoursMinutes()}}catch(a){throw new Error("err")}return!0},valt:function(){return this.value},val:function(a){a=a||"";var b=this.value;return b!=a&&(this.value=a),this.value},_validDate:function(){var a=this.valt();if(a){a=a.split(" ");var b=A.nvl(a[0]),c=A.nvl(a[1]),d=new Date;if(b=b.replace(/[\.,/,\:,\-,\,]/g,"."),-1==b.indexOf(".")&&b.length>1)switch(b.length){case 2:b=b+"."+(d.getMonth()+1)+"."+d.getFullYear();break;case 4:b=b.substr(0,2)+"."+b.substr(2,2)+"."+d.getFullYear();break;case 6:case 8:b=b.substr(0,2)+"."+b.substr(2,2)+"."+b.substr(4)}var e=b.split("."),f=e[0],g=e[1],h=e[2];if(f||(f=d.getDate()),g||(g=d.getMonth()+1),h||(h=d.getFullYear()),2==h.length&&(h=20>h?"20"+h:"19"+h),c=c.replace(/[\.,/,\:,\-,\,]/g,":"),-1==c.indexOf(":")&&c.length>1)switch(c.length){case 2:c+=":00:00";break;case 4:c=c.substr(0,2)+":"+c.substr(2,2)+":00";break;case 6:c=c.substr(0,2)+":"+c.substr(2,2)+":"+c.substr(4)}e=c.split(":");var i=e[0],j=e[1],k=e[2];if(i||(i="00"),j||(j="00"),k||(k="00"),d=new Date(h,g-1,f,i,j,k),f=d.getDate(),g=d.getMonth(),h=d.getFullYear(),i=d.getHours(),j=d.getMinutes(),k=d.getSeconds(),isNaN(f)||isNaN(g)||isNaN(h)||isNaN(i)||isNaN(j)||isNaN(k))throw new Error("Error of date format");var l=function(a){return(String(a).length<2?"0":"")+a};this.val("T"===this.params.type?l(f)+"."+l(g+1)+"."+h+" "+l(i)+":"+l(j)+":"+l(k):l(f)+"."+l(g+1)+"."+h)}},_validHoursMinutes:function(){var a=this.valt();if(a){var b=a.replace(/[\.,/,\:,\-,\,]/g,":");if(-1==b.indexOf(":")&&b.length>1)switch(b.length){case 2:b+=":00";break;case 3:b=b.substr(0,2)+":"+b.substr(2,1)+"0";break;case 4:b=b.substr(0,2)+":"+b.substr(2,2)}var c=b.split(":"),d=A.nvl(c[0]),e=A.nvl(c[1]);d||(d="00"),parseInt(d)>23&&(d="23"),e||(e="00"),parseInt(e)>59&&(e="59");var f=function(a){return String(a).length<2?"0":""+a};this.val(f(d)+":"+f(e))}},_validNumber:function(){var a=this.valt();if(a){if(a=a.replace(/[\,]/g,"."),a=parseFloat(a),isNaN(a))throw new Error("Error number format");a=String(a).replace(/[\.]/g,","),this.val(a)}},_validInteger:function(){var a=this.valt();if(a){if(a=parseInt(a),isNaN(a))throw new Error("Error number format");this.val(a)}}},A.ui.select={params:{dictName:"",dictHash:"",value:"",prefval:"",isOptLoaded:!1},init:function(){this._initParams(),this._loadOptions()},_initParams:function(){var a=this.params;a.dictName=this.attr("DICTNAME"),a.dictHash=this.attr("DICTHASH"),a.value=this.attr("VALUE")||"",a.prefval=this.attr("PREFVAL")||""},_loadOptions:function(){var a=this.params,b=this;a.isOptLoaded||A.dict.load(a.dictName,a.dictHash,function(c){var d,e,f=a.prefval.split(","),g=[],h=[];for(d=0,l=c.items.length;d<l;d++){var i=!1;e=c.items[d],e.sel=e.cd==a.value;for(var j=0;j<f.length;j++)if(e.cd==f[j]){g[j]=e,i=!0;break}i||h.push(e)}for(g=g.concat(h),b.options.length=0,b.options.add(new Option(" ","-",1)),d=0,l=g.length;d<l;d++)e=g[d],b.options.add(new Option(e.txt,e.cd,0,e.sel));a.isOptLoaded=!0})}};